var currentDocument=null,timerSave=2E3,demoHtml=$(".demo").html(),elementID=1,currenteditor=null;
$(document).ready(function(){CKEDITOR.disableAutoInline=!0;if($("#contenteditor").length)var a=CKEDITOR.replace("contenteditor",{allowedContent:!0,contentsCss:"./static/libs/bootstrap/3.2.0/css/bootstrap.min.css"});$(".edit .demo").on("click","[data-target=#editorModal]",function(c){c.preventDefault();currenteditor=$(this).parents(".layoutbox").find(".view");c=currenteditor.html();a.setData(c)});$("#savecontent").click(function(c){c.preventDefault();currenteditor.html(a.getData())});$(".demo, .demo .column").sortable({connectWith:".column",
opacity:.35,handle:".drag"});$(".sidebar-nav .lyrow").draggable({connectToSortable:".demo",helper:"clone",handle:".drag",drag:function(a,d){d.helper.width(400)},stop:function(a,d){$(".demo .column").sortable({opacity:.35,connectWith:".column"})}});$(".sidebar-nav .layoutbox").draggable({connectToSortable:".column",helper:"clone",handle:".drag",drag:function(a,d){d.helper.width(400)},stop:function(a,d){if($(a.toElement).hasClass("demo")){var b=$(this).parents("div.sidebar-nav").find("span.gridcompent");
0<b.length&&(b.popover("show"),b.parents(".nav-header").trigger("click"),setTimeout(function(){b.popover("hide")},5E3))}}});$("#edit").click(function(){$("#container_formbuilder").removeClass("devpreview sourcepreview");$("#container_formbuilder").addClass("edit");removeMenuClasses();$(this).addClass("active");return!1});$(".editlayout").click(function(){$("#container_dashboardbuilder").removeClass("devpreview sourcepreview");$("#container_dashboardbuilder").addClass("edit");removeMenuClasses();$(this).addClass("active");
return!1});$("#clear").click(function(a){a.preventDefault();clearDemo()});$("#devpreview").click(function(){$("#container_formbuilder").removeClass("edit sourcepreview");$("#container_formbuilder").addClass("devpreview");removeMenuClasses();$(this).addClass("active");return!1});$("#sourcepreview").click(function(){$("#container_formbuilder").removeClass("edit");$("#container_formbuilder").addClass("devpreview sourcepreview");removeMenuClasses();$(this).addClass("active");return!1});$(".previewlayout").click(function(){$("#container_dashboardbuilder").removeClass("edit");
$("#container_dashboardbuilder").addClass("devpreview sourcepreview");removeMenuClasses();$(this).addClass("active");return!1});$(".nav-header").click(function(){$(".sidebar-nav .boxes, .sidebar-nav .rows").hide();$(this).next().slideDown()});removeElm();configurationElm();gridSystemGenerator();setInterval(function(){handleSaveLayout()},timerSave)});function handleSaveLayout(){var a=$(".demo").html();a!=window.demoHtml&&(window.demoHtml=a)}
function handleFormEditDialog(){$("#FormOptionsDialog").modal()}function handleEditDialogFromToolbox(a){a=$(a).parents("div.layoutbox");handleEditDialog(a);return!1}
function handleEditDialog(a){var c=a.find("[data-widget='widget']"),d=c.attr("data-widget-name");"singleline"==d?$("#field_onlyinput").show():$("#field_onlyinput").hide();"singleline"==d||"multiLine"==d?$("#field_onlysupportsrc").hide():$("#field_onlysupportsrc").show();var b=c.find("[data-widget='label']");a=c.find("[data-widget='field']");a.attr("id")||(a.attr("id","f_"+elementID),a.attr("name","f_"+elementID),elementID++);$("#field_option_label").val(b.html());$("#field_option_name").val(a.attr("id"));
"singleline"==d&&(b=a.attr("type"),$("#field_option_datatype_"+b).prop("checked",!0));(b=a.attr("data-script-onchange"))&&""!=b?($("#field_option_onchange").val(b),$("#field_option_onchange").show()):($("#field_option_onchange").val(""),$("#field_option_onchange").hide());$("#field_option_source").val(a.attr("data-script-source"));(b=a.attr("data-defaultvalue"))&&""!=b?$("#field_option_defaultvalue").val(b):$("#field_option_defaultvalue").val("");"1"==a.attr("data-script-required")?$("#field_option_required").prop("checked",
!0):$("#field_option_required").prop("checked",!1);"1"==a.attr("data-script-disabled")?$("#field_option_disabled").prop("checked",!0):$("#field_option_disabled").prop("checked",!1);a=a.attr("data-script-sourcetype");"mappingscript"==a?($("#field_option_sourcetype2").prop("checked",!0),$("#field_option_source").show()):"directly"==a?($("#field_option_sourcetype3").prop("checked",!0),$("#field_option_source").show()):($("#field_option_sourcetype1").prop("checked",!0),$("#field_option_source").hide());
a=$("#FieldOptionsDialog").find("#saveChangeBtn");a.unbind("click");a.click(function(){var a=c.find("[data-widget='label']"),b=c.find("[data-widget='field']");a.html($("#field_option_label").val());b.attr("id",$("#field_option_name").val());"checkbox"==d||"multiselect"==d?b.attr("name",$("#field_option_name").val()+"[]"):b.attr("name",$("#field_option_name").val());"singleline"==d&&(a=$("input[name='field_option_datatype']:checked").val(),b.attr("type",a));$("#field_option_required").prop("checked")?
b.attr("data-script-required","1"):b.removeAttr("data-script-required");$("#field_option_disabled").prop("checked")?b.attr("data-script-disabled","1"):b.removeAttr("data-script-disabled");(a=$("#field_option_onchange").val())?b.attr("data-script-onchange",a):b.removeAttr("data-script-onchange");$("#field_option_sourcetype1").prop("checked")?b.attr("data-script-sourcetype",$("#field_option_sourcetype1").val()):$("#field_option_sourcetype2").prop("checked")?b.attr("data-script-sourcetype",$("#field_option_sourcetype2").val()):
$("#field_option_sourcetype3").prop("checked")&&b.attr("data-script-sourcetype",$("#field_option_sourcetype3").val());(a=$("#field_option_defaultvalue").val())&&""!=a&&b.attr("data-defaultvalue",a);a=$("#field_option_source").val();b.attr("data-script-source",a);$("#FieldOptionsDialog").modal("hide");var f=$("#tagcloud_form");f&&(f.empty(),$(".demo").find("[data-widget='field']").each(function(a,b){var d=$(b).attr("id");d&&f.append("<a href='javascript:;' onclick='javascript:copytagtoeditor(this);'><span class='badge bg-green'>"+
d+"</span></a>")}))});$("#FieldOptionsDialog").modal({backdrop:"static"})}function randomNumber(){return randomFromInterval(1,1E6)}function randomFromInterval(a,c){return Math.floor(Math.random()*(c-a+1)+a)}
function gridSystemGenerator(){$(".lyrow .preview input").bind("keyup",function(){var a=0,c="",d=!1,b=$(this).val().split(" ",12);$.each(b,function(b,e){d||(0>=parseInt(e)&&(d=!0),a+=parseInt(e),c+='<div class="col-md-'+e+' column"></div>')});12!=a||d?$(this).parent().prev().hide():($(this).parent().next().children().html(c),$(this).parent().prev().show())})}
function configurationElm(a,c){$(".demo").delegate(".configuration > a","click",function(a){a.preventDefault();a=$(this).parent().next().next().children();$(this).toggleClass("active");a.toggleClass($(this).attr("rel"))});$(".demo").delegate(".configuration .dropdown-menu a","click",function(a){a.preventDefault();a=$(this).parent().parent();var b=a.parent().parent().next().next().children();a.find("li").removeClass("active");$(this).parent().addClass("active");var c="";a.find("a").each(function(){c+=
$(this).attr("rel")+" "});a.parent().removeClass("open");b.removeClass(c);b.addClass($(this).attr("rel"))})}function removeElm(){$(".demo").delegate(".remove","click",function(a){a.preventDefault();$(this).parent().remove();0< !$(".demo .lyrow").length&&clearDemo()})}function clearDemo(){$(".demo").empty()}function removeMenuClasses(){$("#menu-layoutit li button").removeClass("active")}function changeStructure(a,c){$("#download-layout ."+a).removeClass(a).addClass(c)}
function cleanHtml(a){$(a).parent().append($(a).children().html())}
function getCleanedFormSource(a){$("#download-layout").children().html($(a).html());a=$("#download-layout").children();a.find(".preview, .configuration, .drag, .remove").remove();a.find(".lyrow").addClass("removeClean");a.find(".box-element").addClass("removeClean");a.find(".lyrow .lyrow .lyrow .lyrow .lyrow .removeClean").each(function(){cleanHtml(this)});a.find(".lyrow .lyrow .lyrow .lyrow .removeClean").each(function(){cleanHtml(this)});a.find(".lyrow .lyrow .lyrow .removeClean").each(function(){cleanHtml(this)});
a.find(".lyrow .lyrow .removeClean").each(function(){cleanHtml(this)});a.find(".lyrow .removeClean").each(function(){cleanHtml(this)});a.find(".removeClean").each(function(){cleanHtml(this)});a.find(".removeClean").remove();$("#download-layout .column").removeClass("ui-sortable");$("#download-layout .column").removeClass("column");$("#download-layout .row-fluid").removeClass("clearfix").children().removeClass("column");0<$("#download-layout .container").length&&changeStructure("row-fluid","row");
return $("#download-layout .container").html()};