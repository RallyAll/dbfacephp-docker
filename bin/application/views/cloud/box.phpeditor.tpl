<section class="content-header"> <h1> Code </h1> <ol class="breadcrumb"> <li><a href="#module=Dashboard" name="?module=Dashboard" onclick="javascript:return dbfaceMenu.onItemClick(this);"><i class="fa fa-dashboard"></i> [{'strHome'|translate}]</a></li> <li class="active">Code</li> </ol> </section> <section class="content"> [{include file="cloud/box.cloudnotsupport.message.tpl"}] <div class="box box-solid"> <form class="form-horizontal" id="form_code"> <div class="box-body"> <div class="form-group"> <div class="col-sm-12"> <div class="row"> <div class="col-sm-6"> <input type="text" class="form-control" name="codeapi" id="codeapi" value="[{if $code}][{$code.api}][{/if}]" placeholder="Enter access api"> </div> <div class="col-sm-6"> <div class="checkbox"> <label> <input type="checkbox" name="publicaccess" id="publicaccess" [{if $code && $code.public==1}]checked[{/if}]> Disabled </label> </div> </div> </div> </div> </div> <div class="form-group"> <div class="col-sm-12"> <div id="phpeditor" style="width:100%;height:300px">[{if $code}][{$code.content|escape}][{/if}]</div> </div> </div> </div> <div class="box-footer"> <div class="clearfix"> <button type="button" data-widget="open-code" class="btn btn-default" [{if !$enable_cloudcode}]disabled[{/if}]><i class="fa fa-external-link"></i> Open</button> <button type="button" data-widget="save-code" class="btn btn-primary pull-right" [{if !$enable_cloudcode}]disabled[{/if}]>[{'strSaveChanges'|translate}]</button> </div> </div> </form> </div> </section> [{include file="cloud/code.open.dialog.tpl"}] <script>$(function(){window.phpeditor=ace.edit("phpeditor");window.phpeditor.getSession().setMode("ace/mode/php");window.phpeditor.focus();function a(e){var c=window.phpeditor.getValue();var b=$("#codeapi").val();var d=$("#publicaccess").prop("checked")?1:0;$.post("?module=Code&action=save",{content:c,publicaccess:d,codeapi:b},function(f){if(e){e(f)}else{broadcast.propagateAjax("?module=Code")}},"json")}$("button[data-widget='open-code']").click(function(){a(function(c){var b=c.codeapi;$("#codeapi_result").load("[{$code_base_url}]"+b,function(e,d){if(d=="error"){$.scojs_message("Code Error:",$.scojs_message.TYPE_ERROR);return}$("#code_label").html(b);$("#codeapi_preview").modal({show:true})})})});$("button[data-widget='save-code']").click(function(d){var c=window.phpeditor.getSession().getAnnotations();for(var b in c){if(c.hasOwnProperty(b)){if(c[b].type=="error"){return}}}a()})});</script>