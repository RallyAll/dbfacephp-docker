<section class="content-header"> <h1> [{'strConnection'|translate}] <small>[{if isset($conn)}][{'strUpdateDatabaseConnection'|translate}][{else}][{'strSetupDatabaseConnection'|translate}][{/if}]</small> </h1> <ol class="breadcrumb"> [{include file="inc/breadcrumbs.item.home.tpl"}] <li class="active">[{if isset($conn)}][{'strUpdateDatabaseConnection'|translate}][{else}][{'strSetupDatabaseConnection'|translate}][{/if}]</li> </ol> </section> <section class="content"> <div class="box box-solid"> <div class="box-header"> <h3 class="box-title">[{if isset($conn)}][{'strUpdateDatabaseConnection'|translate}][{else}][{'strSetupDatabaseConnection'|translate}][{/if}]</h3> </div> <div class="box-body"> <div id="error_div" class="alert alert-danger alert-dismissable" style="display:none"> <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button> <b>Error!</b> <span id="error_div_message"></span> </div> <form role="form" id="form_conn" class="form-horizontal"> [{if $conn}] <input type="hidden" name="connid" value="[{$conn.connid}]"/> [{/if}] <input type="hidden" name="tag" value="confirm"/> <input type="hidden" name="autocreatedata" value="0"/> <div class="form-group common_field"> <label class="col-sm-2 control-label">[{'strDatabaseType'|translate}]:</label> <div class="col-sm-10"> <select class="form-control" id="dbdriver" name="dbdriver"> <option value="mysqli" [{if $conn && $conn.dbdriver=='mysqli'}]selected[{/if}]>MySQL</option> <option value="pgsql" [{if $conn && $conn.dbdriver=='pgsql'}]selected[{/if}]>PostgreSQL</option> <option value="sqlsrv" [{if $conn && $conn.dbdriver=='sqlsrv'}]selected[{/if}]>Microsoft SQL Server</option> <option value="oci8" [{if $conn && $conn.dbdriver=='oci8'}]selected[{/if}]>Oracle</option> <option value="dsn" [{if $conn && $conn.dbdriver=='dsn'}]selected[{/if}]>Direct RDS DSN</option> <option value="csv" [{if $conn && $conn.dbdriver=='csv'}]selected[{/if}]>CSV File</option> </select> </div> </div> <div class="form-group common_field"> <label class="col-sm-2 control-label">[{'strName'|translate}]:</label> <div class="col-sm-10"> <input type="text" class="form-control" name="name" [{if $conn}]value="[{$conn.name}]"[{/if}] placeholder="[{'strConnNamePl'|translate}]" required/> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">[{'strHost'|translate}]:</label> <div class="col-sm-10"> <input type="text" class="form-control" name="hostname" [{if $conn}]value="[{$conn.hostname}]"[{/if}] placeholder="[{'strHostnamePl'|translate}]"/> </div> </div> <div class="form-group accessuserfield"> <label class="col-sm-2 control-label">[{'strUsername'|translate}]:</label> <div class="col-sm-10"> <input type="text" class="form-control" name="username" [{if $conn}]value="[{$conn.username}]"[{/if}] placeholder="[{'strConnUserNamePl'|translate}]" required/> </div> </div> <div class="form-group accessuserfield"> <label class="col-sm-2 control-label">[{'strPassword'|translate}]:</label> <div class="col-sm-10"> <input type="password" class="form-control" name="password" [{if $conn}]value="[{$conn.password}]"[{/if}] placeholder="[{'strConnPasswordPl'|translate}]" required/> </div> </div> <div class="form-group common_field"> <label class="col-sm-2 control-label" id="nameLabel">[{'strDatabaseName'|translate}]:</label> <div class="col-sm-10"> <div class="input-group"> <input type="text" class="form-control" name="database" [{if $conn}]value="[{$conn.database}]"[{/if}] placeholder="[{'strConnDbName'|translate}]" required/> <span class="input-group-btn"> <button type="button" class="btn btn-info btn-flat" id="btn_pickdb">Pick</button> </span> <div id="div_dblist" class="popover popover-default"> <div class="arrow"></div> <div class="popover-title"><span class="close" data-dismiss="popover-x">&times;</span>Select available database.</div> <div class="popover-content" style="overflow-y:auto;max-height:300px"> </div> </div> </div> </div> </div> <div class="form-group common_field"> <label class="col-sm-2 control-label"></label> <div class="col-sm-10"> <div class="checkbox"> <label><input type="checkbox" name="setdefault" value="1" checked="">[{'setDefaultConnection'|translate}]</label> </div> </div> </div> <div class="form-group csv_field"> <div class="col-sm-12"> <div class="clearfix"> <div class="pull-right"> <label>Delimiter:</label> <select id="delimiter" name="delimiter" onchange="javascript:changeDelimiter()"> <option value="1" selected>,</option> <option value='0'>;</option> <option value='2'>Tab</option> </select> <label>Line Delimiter:</label> <select id="linedelimiter" name="linedelimiter" onchange="javascript:changeDelimiter()"> <option value="0">\n</option> </select> <label>Enclosure:</label> <select id="enclosure" name="enclosure" onchange="javascript:changeDelimiter()"> <option value='0' selected>&quot;</option> <option value="1">'</option> <option value="2">None</option> </select> </div> </div> <div class="uploadtarget"></div><br/> <div id="csv_table" style="display:none"></div> </div> </div> <div class="form-group common_field"> <div class="col-sm-offset-2 col-sm-10"> <button id="btn_create" type="submit" data-style="expand-right" data-size="l" class="btn btn-primary ladda-button"><span class="ladda-label">[{'strSubmit'|translate}]</span></button> </div> </div> </form> </div> </div> </section> <script>function onStart(b,a){}function onComplete(c,b,a){}function onFileStart(b,a){}function onFileProgress(c,a,b){}function onFileComplete(c,b,a){if(a.indexOf("!message!")==0){var d=a.substring("!message!".length);$.scojs_message(d,$.scojs_message.TYPE_ERROR);return}$("#csv_table").html(a).show()}function onFileError(c,b,a){$.scojs_message("File Upload Error: "+a,$.scojs_message.TYPE_ERROR)}function get_upload_action(){var a=$("#delimiter").val();var b=$("#linedelimiter").val();var c=$("#enclosure").val();return"?module=Conn&action=csvupload&delimiter="+a+"&linedelimiter="+b+"&enclosure="+c}$(function(){$("#btn_pickdb").click(function(){$.post("?module=Conn&action=getdblist",$("#form_conn").serialize(),function(a){$("#div_dblist").find("div.popover-content").html(a);$("#div_dblist").popoverX({target:"#btn_pickdb",placement:"top"});$("#div_dblist").popoverX("toggle")})});$("#form_conn").submit(function(b){b.preventDefault();var a=Ladda.create($("button[type=submit]").get(0));a.start();$.post("?module=Conn&action=create",$("#form_conn").serialize(),function(e){a.stop();var c=e.result;var d=e.message;if(!c){$("#error_div_message").html(d);$("#error_div").show()}else{dbface.shouldreload=true;broadcast.propagateAjax("module=Conn&action=index")}},"json").fail(function(){broadcast.propagateAjax("module=Conn&action=index")})});$(".uploadtarget").dropper({action:get_upload_action,label:"[{'strUploadLabel'|translate}]",postKey:"userfile",maxSize:524288000}).on("start.dropper",onStart).on("complete.dropper",onComplete).on("fileStart.dropper",onFileStart).on("fileProgress.dropper",onFileProgress).on("fileComplete.dropper",onFileComplete).on("fileError.dropper",onFileError);$("#dbdriver").change(function(){var a=$("#dbdriver option:selected").val();$("input[name='database']").attr("placeholder","[{'strConnDbName'|translate}]").blur();$("#nameLabel").html("[{'strDatabaseName'|translate}]:");if(a=="csv"){$(".form-group").hide();$(".csv_field").show()}else{if(a=="sqlite"){$(".form-group").hide();$(".csv_field").hide()}else{if(a=="dsn"){$(".form-group").hide();$(".csv_field").hide();$(".accessuserfield").show();$("input[name='database']").attr("placeholder","[{'strConnDSNTip'|translate}]").blur();$("#nameLabel").html("[{'DSN'|translate}]:")}else{$(".form-group").show();$(".csv_field").hide()}}}$(".common_field").show()}).change()});</script>