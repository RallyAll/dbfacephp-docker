<section class="content-header"> <h1> [{$table}] <small>Control panel</small> </h1> <ol class="breadcrumb"> [{include file="inc/breadcrumbs.item.home.tpl"}] <li>Database Structure</li> <li class="active">[{$table}]</li> </ol> </section> <section class="content"> <div class="row"> <section class="col-md-12"> <div class="box"> <div class="box-header"> <h3 class="box-title">Edit Field</h3> </div> <form class="form-horizontal" id="form_field"> <div class="box-body"> <input type="hidden" name="connid" value="[{$connid}]"/> <input type="hidden" name="table" value="[{$table}]"/> <input type="hidden" name="orig_num_fields" value="1"/> <input type="hidden" name="selected[0]" value="[{$fieldname}]"/> <input type="hidden" name="true_selected[0]" value="[{$fieldname}]"/> <input type="hidden" name="field_orig[0]" value="[{$fieldname}]"/> <input type="hidden" name="field_length_orig[0]" value="11"/> <input type="hidden" name="field_default_orig[0]" value=""/> <div class="form-group"> <label for="field_0_1" class="col-sm-2 control-label">Field:</label> <div class="col-sm-10"> <input type="text" class="form-control" id="field_0_1" name="field_name[0]" maxlength="64" value="[{$fieldname}]"> </div> </div> <div class="form-group"> <label for="field_0_2" class="col-sm-2 control-label">Type<a href="http://dev.mysql.com/doc/refman/5.1/en/data-types.html" target="mysql_doc"> <img class="icon" src="[{#s_base#}]/dbfacephp/img/s/b_help.png" width="11" height="11" alt="Documentation" title="Documentation"/></a></label> <div class="col-sm-10"> <select name="field_type[0]" id="field_0_2" class="form-control"> <option value="INT" [{if $field.fieldspec.type|upper == 'INT'}]selected[{/if}]>INT</option> <option value="VARCHAR" [{if $field.fieldspec.type|upper == 'VARCHAR'}]selected[{/if}]>VARCHAR </option> <option value="CHAR" [{if $field.fieldspec.type|upper == 'CHAR'}]selected[{/if}]>CHAR</option> <option value="TEXT" [{if $field.fieldspec.type|upper == 'TEXT'}]selected[{/if}]>TEXT</option> <option value="DATE" [{if $field.fieldspec.type|upper == 'DATE'}]selected[{/if}]>DATE</option> <option value="TIMESTAMP" [{if $field.fieldspec.type|upper == 'TIMESTAMP'}]selected[{/if}]>TIMESTAMP </option> <optgroup label="NUMERIC"> <option value="TINYINT" [{if $field.fieldspec.type|upper == 'TINYINT'}]selected[{/if}]>TINYINT </option> <option value="SMALLINT" [{if $field.fieldspec.type|upper == 'SMALLINT'}]selected[{/if}]>SMALLINT </option> <option value="MEDIUMINT" [{if $field.fieldspec.type|upper == 'MEDIUMINT'}]selected[{/if}]> MEDIUMINT </option> <option value="BIGINT" [{if $field.fieldspec.type|upper == 'BIGINT'}]selected[{/if}]>BIGINT</option> <option value="-">-</option> <option value="DECIMAL" [{if $field.fieldspec.type|upper == 'DECIMAL'}]selected[{/if}]>DECIMAL </option> <option value="FLOAT" [{if $field.fieldspec.type|upper == 'FLOAT'}]selected[{/if}]>FLOAT</option> <option value="DOUBLE" [{if $field.fieldspec.type|upper == 'DOUBLE'}]selected[{/if}]>DOUBLE</option> <option value="REAL" [{if $field.fieldspec.type|upper == 'REAL'}]selected[{/if}]>REAL</option> <option value="-">-</option> <option value="BIT" [{if $field.fieldspec.type|upper == 'BIT'}]selected[{/if}]>BIT</option> <option value="BOOLEAN" [{if $field.fieldspec.type|upper == 'BOOLEAN'}]selected[{/if}]>BOOLEAN </option> <option value="SERIAL" [{if $field.fieldspec.type|upper == 'SERIAL'}]selected[{/if}]>SERIAL</option> </optgroup> <optgroup label="DATE and TIME"> <option value="DATETIME" [{if $field.fieldspec.type|upper == 'DATETIME'}]selected[{/if}]>DATETIME </option> <option value="TIME" [{if $field.fieldspec.type|upper == 'TIME'}]selected[{/if}]>TIME</option> <option value="YEAR" [{if $field.fieldspec.type|upper == 'YEAR'}]selected[{/if}]>YEAR</option> </optgroup> <optgroup label="STRING"> <option value="TINYTEXT" [{if $field.fieldspec.type|upper == 'TINYTEXT'}]selected[{/if}]>TINYTEXT </option> <option value="MEDIUMTEXT" [{if $field.fieldspec.type|upper == 'MEDIUMTEXT'}]selected[{/if}]> MEDIUMTEXT </option> <option value="LONGTEXT" [{if $field.fieldspec.type|upper == 'LONGTEXT'}]selected[{/if}]>LONGTEXT </option> <option value="-">-</option> <option value="BINARY" [{if $field.fieldspec.type|upper == 'BINARY'}]selected[{/if}]>BINARY</option> <option value="VARBINARY" [{if $field.fieldspec.type|upper == 'VARBINARY'}]selected[{/if}]> VARBINARY </option> <option value="-">-</option> <option value="TINYBLOB" [{if $field.fieldspec.type|upper == 'TINYBLOB'}]selected[{/if}]>TINYBLOB </option> <option value="MEDIUMBLOB" [{if $field.fieldspec.type|upper == 'MEDIUMBLOB'}]selected[{/if}]> MEDIUMBLOB </option> <option value="BLOB" [{if $field.fieldspec.type|upper == 'BLOB'}]selected[{/if}]>BLOB</option> <option value="LONGBLOB" [{if $field.fieldspec.type|upper == 'LONGBLOB'}]selected[{/if}]>LONGBLOB </option> <option value="-">-</option> <option value="ENUM" [{if $field.fieldspec.type|upper == 'ENUM'}]selected[{/if}]>ENUM</option> <option value="SET" [{if $field.fieldspec.type|upper == 'SET'}]selected[{/if}]>SET</option> </optgroup> <optgroup label="SPATIAL"> <option value="GEOMETRY" [{if $field.fieldspec.type|upper == 'GEOMETRY'}]selected[{/if}]>GEOMETRY </option> <option value="POINT" [{if $field.fieldspec.type|upper == 'POINT'}]selected[{/if}]>POINT</option> <option value="LINESTRING" [{if $field.fieldspec.type|upper == 'LINESTRING'}]selected[{/if}]> LINESTRING </option> <option value="POLYGON" [{if $field.fieldspec.type|upper == 'POLYGON'}]selected[{/if}]>POLYGON </option> <option value="MULTIPOINT" [{if $field.fieldspec.type|upper == 'MULTIPOINT'}]selected[{/if}]> MULTIPOINT </option> <option value="MULTILINESTRING" [{if $field.fieldspec.type|upper == 'MULTILINESTRING'}]selected[{/if}]>MULTILINESTRING </option> <option value="MULTIPOLYGON" [{if $field.fieldspec.type|upper == 'MULTIPOLYGON'}]selected[{/if}]> MULTIPOLYGON </option> <option value="GEOMETRYCOLLECTION" [{if $field.fieldspec.type|upper == 'GEOMETRYCOLLECTION'}]selected[{/if}]>GEOMETRYCOLLECTION </option> </optgroup> </select> </div> </div> <div class="form-group"> <label for="field_0_3" class="col-sm-2 control-label">Length/Values:</label> <div class="col-sm-10"> <input id="field_0_3" type="text" name="field_length[0]" size="30" class="form-control" value="[{$field.fieldspec.spec_in_brackets}]"/> </div> </div> <div class="form-group"> <label for="field_0_3" class="col-sm-2 control-label">Default:</label> <div class="col-sm-3"> <select name="field_default_type[0]" class="form-control"> <option value="NONE" [{if $field.fieldspec.DefaultType=='NONE'}]selected[{/if}]>None</option> <option value="USER_DEFINED" [{if $field.fieldspec.DefaultType=='USER_DEFINED'}]selected[{/if}]>As defined: </option> <option value="NULL" [{if $field.fieldspec.DefaultType=='NULL'}]selected[{/if}]>NULL</option> <option value="CURRENT_TIMESTAMP" [{if $field.fieldspec.DefaultType=='CURRENT_TIMESTAMP'}]selected[{/if}]>CURRENT_TIMESTAMP </option> </select> </div> <div class="col-sm-6"> <input id="field_0_4" type="text" name="field_default_value[0]" size="12" value="[{$field.fieldspec.DefaultValue}]" class="form-control"/> </div> </div> <div class="form-group"> <label for="field_0_3" class="col-sm-2 control-label">Collation:</label> <div class="col-sm-10"> <select name="field_collation[0]" id="field_0_5" class="form-control"> <option value=""></option> [{foreach key=charset item=collation from=$collations}] <optgroup label="[{$charset}]" title="[{$charset}]"> [{section name=j loop=$collation}] <option value="[{$collation[j]}]" title="[{$collation[j]}]" [{if $field.Collation == $collation[j]}]selected[{/if}]>[{$collation[j]}] </option> [{/section}] </optgroup> [{/foreach}] </select> </div> </div> <div class="form-group"> <label for="field_0_3" class="col-sm-2 control-label">Attributes:</label> <div class="col-sm-10"> <select name="field_attribute[0]" id="field_0_6" class="form-control"> <option value="" [{if $field.fieldspec.attribute==''}]selected[{/if}]></option> <option value="BINARY" [{if $field.fieldspec.attribute=='BINARY'}]selected[{/if}]>BINARY</option> <option value="UNSIGNED" [{if $field.fieldspec.attribute=='UNSIGNED'}]selected[{/if}]>UNSIGNED </option> <option value="UNSIGNED ZEROFILL" [{if $field.fieldspec.attribute=='UNSIGNED ZEROFILL'}]selected[{/if}]>UNSIGNED ZEROFILL </option> <option value="on update CURRENT_TIMESTAMP" [{if $field.fieldspec.attribute=='on update CURRENT_TIMESTAMP'}]selected[{/if}]>on update CURRENT_TIMESTAMP </option> </select> </div> </div> <div class="form-group"> <div class="col-sm-offset-2 col-sm-10"> <div class="checkbox"> <label> <input name="field_null[0]" id="field_0_7" type="checkbox" value="NULL" [{if $field.Null!='NO'}]checked[{/if}]/> Null </label> </div> <div class="checkbox"> <label> <input name="field_extra[0]" id="field_0_8" type="checkbox" value="AUTO_INCREMENT" [{if $field.Extra=='AUTO_INCREMENT'}]checked[{/if}]/> AUTO_INCREMENT </label> </div> </div> </div> <div class="form-group"> <label for="field_0_3" class="col-sm-2 control-label">Comments:</label> <div class="col-sm-10"> <input id="field_0_9" type="text" name="field_comments[0]" size="12" value="[{$field.Comment}]" class="form-control"/> </div> </div> </div> <div class="box-footer clearfix "> <button type="button" class="btn btn-default" id="backbtn">Cancel</button> <button type="button" class="btn btn-info pull-right" id="btn_savefield">Save</button> </div> </form> </div> </section> </div> </section> <script>
$(function() {
  $('#backbtn').click(function() {
    broadcast.propagateAjax("#module=Tablestructure&connid="+[{$connid}]+"&viewname="+'[{$table}]');
  });

  $('#btn_savefield').click(function() {
    $.post("?module=Tablestructure&action=editfield",
      $('#form_field').serialize()+"&do_save_data=Save",
      function(json){
        var status = json.status;
        var message = json.message;
        if (status == 0) {
          $.scojs_message(message, $.scojs_message.TYPE_ERROR);
        } else {
          // success, open the table structure
          var tablename = json.table;
          broadcast.propagateAjax("#module=Tablestructure&viewname="+'[{$table}]'+"&connid="+[{$connid}]);
        }
      }, 'json'
    );
  });
});
</script>